from reportlab.platypus import SimpleDocTemplate, Paragraph, Spacer, Table, TableStyle, Image
from reportlab.lib.styles import getSampleStyleSheet, ParagraphStyle
from reportlab.lib.pagesizes import A4
from reportlab.lib import colors
from reportlab.lib.units import cm
import qrcode

# إنشاء ملف PDF
doc = SimpleDocTemplate("cv.pdf", pagesize=A4)

# الأنماط
styles = getSampleStyleSheet()
styles.add(ParagraphStyle(name="Title", fontSize=18, leading=22, spaceAfter=10, alignment=1, textColor=colors.HexColor("#2E4053")))
styles.add(ParagraphStyle(name="SectionHeader", fontSize=12, leading=14, spaceAfter=6, textColor=colors.HexColor("#1F618D"), spaceBefore=12, underlineWidth=1))
styles.add(ParagraphStyle(name="NormalText", fontSize=10, leading=12, spaceAfter=4))

# QR Code (يربط بالبريد مثلاً)
qr = qrcode.make("mailto:yourmail@example.com")
qr.save("qr.png")

qr_img = Image("qr.png", width=2*cm, height=2*cm)

# العمود الأيسر
left_column = [
    Paragraph("<b>📞 الهاتف:</b> 0555555555", styles["NormalText"]),
    Paragraph("<b>📧 البريد:</b> yourmail@example.com", styles["NormalText"]),
    Paragraph("<b>📍 الموقع:</b> جازان - السعودية", styles["NormalText"]),
    Spacer(1, 10),

    Paragraph("المهارات", styles["SectionHeader"]),
    Paragraph("- بايثون", styles["NormalText"]),
    Paragraph("- تحليل البيانات", styles["NormalText"]),
    Paragraph("- إدارة المشاريع", styles["NormalText"]),
    Spacer(1, 10),

    Paragraph("الدورات", styles["SectionHeader"]),
    Paragraph("- دورة الذكاء الاصطناعي", styles["NormalText"]),
    Paragraph("- دورة إدارة الوقت", styles["NormalText"]),
    Spacer(1, 10),

    Paragraph("اللغات", styles["SectionHeader"]),
    Paragraph("- العربية: ممتاز", styles["NormalText"]),
    Paragraph("- الإنجليزية: جيد جداً", styles["NormalText"]),
    Spacer(1, 10),

    qr_img
]

# العمود الأيمن
right_column = [
    Paragraph("محمد عبدالرحمن حكمي", styles["Title"]),
    Paragraph("مهندس برمجيات | مطور بايثون", styles["NormalText"]),
    Spacer(1, 12),

    Paragraph("الهدف المهني", styles["SectionHeader"]),
    Paragraph("أسعى إلى تطوير مهاراتي التقنية والمساهمة في بناء حلول رقمية مبتكرة تخدم التحول الرقمي.", styles["NormalText"]),
    Spacer(1, 12),

    Paragraph("الخبرات العملية", styles["SectionHeader"]),
    Paragraph("<b>شركة تقنية XYZ</b> (2022 - الآن)", styles["NormalText"]),
    Paragraph("مطور نظم - تطوير تطبيقات بايثون وتحليل بيانات.", styles["NormalText"]),
    Spacer(1, 6),

    Paragraph("<b>شركة حلول ABC</b> (2020 - 2022)", styles["NormalText"]),
    Paragraph("مهندس دعم فني - إدارة الأنظمة وتحسين الأداء.", styles["NormalText"]),
    Spacer(1, 12),

    Paragraph("التعليم", styles["SectionHeader"]),
    Paragraph("بكالوريوس هندسة حاسب - جامعة جازان (2019)", styles["NormalText"]),
]

# دمج الأعمدة في جدول
data = [[left_column, right_column]]
table = Table(data, colWidths=[6*cm, 10*cm])

table.setStyle(TableStyle([
    ("VALIGN", (0,0), (-1,-1), "TOP"),
    ("LEFTPADDING", (0,0), (-1,-1), 10),
    ("RIGHTPADDING", (0,0), (-1,-1), 10),
    ("TOPPADDING", (0,0), (-1,-1), 5),
    ("BOTTOMPADDING", (0,0), (-1,-1), 5),
]))

# بناء الـ PDF
elements = [table]
doc.build(elements)

print("✅ تم إنشاء ملف السيرة الذاتية cv.pdf بنجاح")