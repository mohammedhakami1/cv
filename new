import arabic_reshaper
from bidi.algorithm import get_display
from reportlab.platypus import SimpleDocTemplate, Paragraph, Spacer, Image, Table, TableStyle
from reportlab.lib.styles import ParagraphStyle
from reportlab.lib.enums import TA_RIGHT
from reportlab.pdfbase import pdfmetrics
from reportlab.pdfbase.ttfonts import TTFont
from reportlab.lib import colors
import qrcode

# ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø· Ø§Ù„Ø¹Ø±Ø¨ÙŠ
pdfmetrics.registerFont(TTFont("Amiri", "Amiri-Regular.ttf"))

# Ø¯Ø§Ù„Ø© ØªØ¬Ù‡ÙŠØ² Ø§Ù„Ù†Øµ Ø§Ù„Ø¹Ø±Ø¨ÙŠ
def ar_text(text):
    reshaped = arabic_reshaper.reshape(text)
    return get_display(reshaped)

# Ø£Ù†Ù…Ø§Ø· Ø§Ù„Ù†ØµÙˆØµ
style_title = ParagraphStyle(name="Title", fontName="Amiri", fontSize=18,
                             alignment=TA_RIGHT, textColor=colors.HexColor("#0D47A1"),
                             spaceAfter=14, leading=22)
style_section = ParagraphStyle(name="Section", fontName="Amiri", fontSize=13,
                               alignment=TA_RIGHT, textColor=colors.HexColor("#1565C0"),
                               spaceAfter=6, leading=18)
style_normal = ParagraphStyle(name="Normal", fontName="Amiri", fontSize=11,
                              alignment=TA_RIGHT, textColor=colors.black, leading=16)

# Ø¥Ù†Ø´Ø§Ø¡ Ø¨Ø§Ø±ÙƒÙˆØ¯ QR Ù„Ù„Ø¥ÙŠÙ…ÙŠÙ„
qr_data = "mailto:Mohammed.a.hakami@gmail.com"
qr_img = qrcode.make(qr_data)
qr_path = "qr_email.png"
qr_img.save(qr_path)

# Ø§Ù„Ø¹Ù…ÙˆØ¯ Ø§Ù„Ø£ÙŠØ³Ø± (Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø´Ø®ØµÙŠØ© + Ù…Ù‡Ø§Ø±Ø§Øª + Ø¨Ø§Ø±ÙƒÙˆØ¯)
left_column = []
left_column.append(Paragraph(ar_text("ğŸ“ 0599515695"), style_normal))
left_column.append(Paragraph(ar_text("âœ‰ Mohammed.a.hakami@gmail.com"), style_normal))
left_column.append(Paragraph(ar_text("ğŸ“ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©"), style_normal))
left_column.append(Spacer(1, 12))

left_column.append(Paragraph(ar_text("ğŸ› ï¸ Ø§Ù„Ù…Ù‡Ø§Ø±Ø§Øª"), style_section))
skills = [
    "Ø§Ù„Ù‚ÙŠØ§Ø¯Ø© ÙˆØ¥Ø¯Ø§Ø±Ø© Ø§Ù„ÙØ±Ù‚",
    "Ø§Ù„Ø§Ø³ØªØ´Ø§Ø±Ø§Øª Ø§Ù„Ø¥Ø¯Ø§Ø±ÙŠØ©",
    "ØµÙŠØ§ØºØ© Ø§Ù„Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ§Øª",
    "Ø§Ù„ØªØ®Ø·ÙŠØ· ÙˆØ§Ù„ØªÙ†Ø¸ÙŠÙ…",
    "Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¬ÙˆØ¯Ø©",
    "Ø§Ù„ØªÙˆØ§ØµÙ„ Ø§Ù„ÙØ¹Ø§Ù„",
    "Ø§Ù„Ø¹Ù…Ù„ ØªØ­Øª Ø§Ù„Ø¶ØºØ·",
    "Ø­Ù„ Ø§Ù„Ù…Ø´ÙƒÙ„Ø§Øª",
    "Ø§Ù„Ø­Ø§Ø³Ø¨ Ø§Ù„Ø¢Ù„ÙŠ"
]
for skill in skills:
    left_column.append(Paragraph(ar_text("â€¢ " + skill), style_normal))
left_column.append(Spacer(1, 12))

left_column.append(Paragraph(ar_text("ğŸ“š Ø§Ù„Ø¯ÙˆØ±Ø§Øª"), style_section))
left_column.append(Paragraph(ar_text("Ø§Ù„Ø­Ø§Ø³Ø¨ Ø§Ù„Ø¢Ù„ÙŠØŒ Ø§Ù„Ù‚ÙŠØ§Ø¯Ø©ØŒ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹Ø§Ù…Ø©ØŒ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø®Ø§Ø·Ø±ØŒ Ø§Ù„Ø§Ù‚ØªØµØ§Ø¯ØŒ Ø§Ù„ØªØ³ÙˆÙŠÙ‚ØŒ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§ØªØŒ Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§ØªØŒ ØªØ·ÙˆÙŠØ± Ø§Ù„Ø°Ø§ØªØŒ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ÙˆÙ‚ØªØŒ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹."), style_normal))
left_column.append(Spacer(1, 12))

left_column.append(Paragraph(ar_text("ğŸŒ Ø§Ù„Ù„ØºØ§Øª"), style_section))
left_column.append(Paragraph(ar_text("Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©: Ø§Ù„Ù„ØºØ© Ø§Ù„Ø£Ù…"), style_normal))
left_column.append(Paragraph(ar_text("Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©: Ù…Ø³ØªÙˆÙ‰ Ø¬ÙŠØ¯"), style_normal))
left_column.append(Spacer(1, 30))

left_column.append(Image(qr_path, width=100, height=100))

# Ø§Ù„Ø¹Ù…ÙˆØ¯ Ø§Ù„Ø£ÙŠÙ…Ù† (Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ)
right_column = []
right_column.append(Paragraph(ar_text("Ù…Ø­Ù…Ø¯ Ø¹Ø¨Ø¯Ø§Ù„Ø±Ø­Ù…Ù† Ø­ÙƒÙ…ÙŠ"), style_title))
right_column.append(Paragraph(ar_text("Ø¥Ø¯Ø§Ø±ÙŠ ÙˆØªÙ†ÙÙŠØ°ÙŠ ÙŠØªÙ…ØªØ¹ Ø¨Ø®Ø¨Ø±Ø© ÙˆØ§Ø³Ø¹Ø© ÙˆÙ…ØªÙ†ÙˆØ¹Ø© ÙÙŠ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹Ø§Ù…Ø©ØŒ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ÙØ±ÙˆØ¹ ÙˆØ§Ù„Ù…Ù†Ø§Ø·Ù‚ØŒ ÙˆØ§Ù„ØªØ·ÙˆÙŠØ±."), style_normal))
right_column.append(Spacer(1, 12))

right_column.append(Paragraph(ar_text("ğŸ¯ Ø§Ù„Ù‡Ø¯Ù Ø§Ù„Ù…Ù‡Ù†ÙŠ"), style_section))
right_column.append(Paragraph(ar_text("Ø§Ù„Ø§Ù†Ø¶Ù…Ø§Ù… Ø¥Ù„Ù‰ Ù…Ø¤Ø³Ø³Ø§Øª Ø£Ùˆ Ø´Ø±ÙƒØ§Øª Ø±Ø§Ø¦Ø¯Ø© Ø£ÙØ³Ù‡Ù… ÙÙŠÙ‡Ø§ Ø¨Ø®Ø¨Ø±Ø§ØªÙŠ ÙÙŠ Ø§Ù„Ù‚ÙŠØ§Ø¯Ø© ÙˆØ§Ù„Ø¥Ø¯Ø§Ø±Ø© Ù„ØªØ·ÙˆÙŠØ± Ø§Ù„Ø£Ø¯Ø§Ø¡ ÙˆØªØ­Ù‚ÙŠÙ‚ Ø§Ù„Ø£Ù‡Ø¯Ø§Ù Ø§Ù„Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ©ØŒ Ø¹Ø¨Ø± ØªØ¹Ø²ÙŠØ² Ø§Ù„ÙƒÙØ§Ø¡Ø© Ø§Ù„ØªØ´ØºÙŠÙ„ÙŠØ©ØŒ ÙˆØ±ÙØ¹ Ù…Ø³ØªÙˆÙŠØ§Øª Ø§Ù„Ø¬ÙˆØ¯Ø© ÙˆØ§Ù„Ø¥Ù†ØªØ§Ø¬ÙŠØ©ØŒ ÙˆØ®Ù„Ù‚ Ù‚ÙŠÙ…Ø© Ù…Ø¶Ø§ÙØ© Ù…Ø³ØªØ¯Ø§Ù…Ø© ØªØ¯Ø¹Ù… Ø§Ù„Ù†Ø¬Ø§Ø­ ÙˆØ§Ù„ØªØ·ÙˆØ±."), style_normal))
right_column.append(Spacer(1, 12))

right_column.append(Paragraph(ar_text("ğŸ’¼ Ø§Ù„Ø®Ø¨Ø±Ø§Øª Ø§Ù„Ø¹Ù…Ù„ÙŠØ©"), style_section))
experiences = [